!function($,e,t,o){"use strict";$.fn.sticky=function(t){var n=$(this),i=n.selector||"",s=(new Date).getTime(),r=[],l=arguments[0],c="string"==typeof l,a=[].slice.call(arguments,1),f;return n.each(function(){var n=$.isPlainObject(t)?$.extend(!0,{},$.fn.sticky.settings,t):$.extend({},$.fn.sticky.settings),m=n.className,u=n.namespace,d=n.error,h="."+u,p="module-"+u,g=$(this),b=$(e),v=$(n.scrollContext),x,C,S=g.selector||"",y=g.data(p),k=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||e.msRequestAnimationFrame||function(e){setTimeout(e,0)},T=this,z,w;w={initialize:function(){w.determineContainer(),w.determineContext(),w.verbose("Initializing sticky",n,x),w.save.positions(),w.checkErrors(),w.bind.events(),n.observeChanges&&w.observeChanges(),w.instantiate()},instantiate:function(){w.verbose("Storing instance of module",w),y=w,g.data(p,w)},destroy:function(){w.verbose("Destroying previous instance"),w.reset(),z&&z.disconnect(),b.off("load"+h,w.event.load).off("resize"+h,w.event.resize),v.off("scrollchange"+h,w.event.scrollchange),g.removeData(p)},observeChanges:function(){var t=C[0];"MutationObserver"in e&&(z=new MutationObserver(function(e){clearTimeout(w.timer),w.timer=setTimeout(function(){w.verbose("DOM tree modified, updating sticky menu",e),w.refresh()},100)}),z.observe(T,{childList:!0,subtree:!0}),z.observe(t,{childList:!0,subtree:!0}),w.debug("Setting up mutation observer",z))},determineContainer:function(){x=g.offsetParent()},determineContext:function(){return C=n.context?$(n.context):x,0===C.length?void w.error(d.invalidContext,n.context,g):void 0},checkErrors:function(){return w.is.hidden()&&w.error(d.visible,g),w.cache.element.height>w.cache.context.height?(w.reset(),void w.error(d.elementSize,g)):void 0},bind:{events:function(){b.on("load"+h,w.event.load).on("resize"+h,w.event.resize),v.off("scroll"+h).on("scroll"+h,w.event.scroll).on("scrollchange"+h,w.event.scrollchange)}},event:{load:function(){w.verbose("Page contents finished loading"),k(w.refresh)},resize:function(){w.verbose("Window resized"),k(w.refresh)},scroll:function(){k(function(){v.triggerHandler("scrollchange"+h,v.scrollTop())})},scrollchange:function(e,t){w.stick(t),n.onScroll.call(T)}},refresh:function(e){w.reset(),n.context||w.determineContext(),e&&w.determineContainer(),w.save.positions(),w.stick(),n.onReposition.call(T)},supports:{sticky:function(){var e=$("<div/>"),t=e[0];return e.addClass(m.supported),e.css("position").match("sticky")}},save:{lastScroll:function(e){w.lastScroll=e},elementScroll:function(e){w.elementScroll=e},positions:function(){var e={height:v.height()},t={margin:{top:parseInt(g.css("margin-top"),10),bottom:parseInt(g.css("margin-bottom"),10)},offset:g.offset(),width:g.outerWidth(),height:g.outerHeight()},o={offset:C.offset(),height:C.outerHeight()},n={height:x.outerHeight()};w.is.standardScroll()||(w.debug("Non-standard scroll. Removing scroll offset from element offset"),e.top=v.scrollTop(),e.left=v.scrollLeft(),t.offset.top+=e.top,o.offset.top+=e.top,t.offset.left+=e.left,o.offset.left+=e.left),w.cache={fits:t.height<e.height,scrollContext:{height:e.height},element:{margin:t.margin,top:t.offset.top-t.margin.top,left:t.offset.left,width:t.width,height:t.height,bottom:t.offset.top+t.height},context:{top:o.offset.top,height:o.height,bottom:o.offset.top+o.height}},w.set.containerSize(),w.set.size(),w.stick(),w.debug("Caching element positions",w.cache)}},get:{direction:function(e){var t="down";return e=e||v.scrollTop(),w.lastScroll!==o&&(w.lastScroll<e?t="down":w.lastScroll>e&&(t="up")),t},scrollChange:function(e){return e=e||v.scrollTop(),w.lastScroll?e-w.lastScroll:0},currentElementScroll:function(){return w.elementScroll?w.elementScroll:w.is.top()?Math.abs(parseInt(g.css("top"),10))||0:Math.abs(parseInt(g.css("bottom"),10))||0},elementScroll:function(e){e=e||v.scrollTop();var t=w.cache.element,o=w.cache.scrollContext,i=w.get.scrollChange(e),s=t.height-o.height+n.offset,r=w.get.currentElementScroll(),l=r+i;return r=w.cache.fits||0>l?0:l>s?s:l}},remove:{lastScroll:function(){delete w.lastScroll},elementScroll:function(e){delete w.elementScroll},offset:function(){g.css("margin-top","")}},set:{offset:function(){w.verbose("Setting offset on element",n.offset),g.css("margin-top",n.offset)},containerSize:function(){var e=x.get(0).tagName;"HTML"===e||"body"==e?w.determineContainer():Math.abs(x.outerHeight()-w.cache.context.height)>n.jitter&&(w.debug("Context has padding, specifying exact height for container",w.cache.context.height),x.css({height:w.cache.context.height}))},minimumSize:function(){var e=w.cache.element;x.css("min-height",e.height)},scroll:function(e){w.debug("Setting scroll on element",e),w.elementScroll!=e&&(w.is.top()&&g.css("bottom","").css("top",-e),w.is.bottom()&&g.css("top","").css("bottom",e))},size:function(){0!==w.cache.element.height&&0!==w.cache.element.width&&(T.style.setProperty("width",w.cache.element.width+"px","important"),T.style.setProperty("height",w.cache.element.height+"px","important"))}},is:{standardScroll:function(){return v[0]==e},top:function(){return g.hasClass(m.top)},bottom:function(){return g.hasClass(m.bottom)},initialPosition:function(){return!w.is.fixed()&&!w.is.bound()},hidden:function(){return!g.is(":visible")},bound:function(){return g.hasClass(m.bound)},fixed:function(){return g.hasClass(m.fixed)}},stick:function(e){var t=e||v.scrollTop(),o=w.cache,i=o.fits,s=o.element,r=o.scrollContext,l=o.context,c=w.is.bottom()&&n.pushing?n.bottomOffset:n.offset,e={top:t+c,bottom:t+c+r.height},a=w.get.direction(e.top),f=i?0:w.get.elementScroll(e.top),m=!i,u=0!==s.height;u&&(w.is.initialPosition()?e.top>=l.bottom?(w.debug("Initial element position is bottom of container"),w.bindBottom()):e.top>s.top&&(s.height+e.top-f>=l.bottom?(w.debug("Initial element position is bottom of container"),w.bindBottom()):(w.debug("Initial element position is fixed"),w.fixTop())):w.is.fixed()?w.is.top()?e.top<=s.top?(w.debug("Fixed element reached top of container"),w.setInitialPosition()):s.height+e.top-f>=l.bottom?(w.debug("Fixed element reached bottom of container"),w.bindBottom()):m&&(w.set.scroll(f),w.save.lastScroll(e.top),w.save.elementScroll(f)):w.is.bottom()&&(e.bottom-s.height<=s.top?(w.debug("Bottom fixed rail has reached top of container"),w.setInitialPosition()):e.bottom>=l.bottom?(w.debug("Bottom fixed rail has reached bottom of container"),w.bindBottom()):m&&(w.set.scroll(f),w.save.lastScroll(e.top),w.save.elementScroll(f))):w.is.bottom()&&(e.top<=s.top?(w.debug("Jumped from bottom fixed to top fixed, most likely used home/end button"),w.setInitialPosition()):n.pushing?w.is.bound()&&e.bottom<=l.bottom&&(w.debug("Fixing bottom attached element to bottom of browser."),w.fixBottom()):w.is.bound()&&e.top<=l.bottom-s.height&&(w.debug("Fixing bottom attached element to top of browser."),w.fixTop())))},bindTop:function(){w.debug("Binding element to top of parent container"),w.remove.offset(),g.css({left:"",top:"",marginBottom:""}).removeClass(m.fixed).removeClass(m.bottom).addClass(m.bound).addClass(m.top),n.onTop.call(T),n.onUnstick.call(T)},bindBottom:function(){w.debug("Binding element to bottom of parent container"),w.remove.offset(),g.css({left:"",top:""}).removeClass(m.fixed).removeClass(m.top).addClass(m.bound).addClass(m.bottom),n.onBottom.call(T),n.onUnstick.call(T)},setInitialPosition:function(){w.debug("Returning to initial position"),w.unfix(),w.unbind()},fixTop:function(){w.debug("Fixing element to top of page"),w.set.minimumSize(),w.set.offset(),g.css({left:w.cache.element.left,bottom:"",marginBottom:""}).removeClass(m.bound).removeClass(m.bottom).addClass(m.fixed).addClass(m.top),n.onStick.call(T)},fixBottom:function(){w.debug("Sticking element to bottom of page"),w.set.minimumSize(),w.set.offset(),g.css({left:w.cache.element.left,bottom:"",marginBottom:""}).removeClass(m.bound).removeClass(m.top).addClass(m.fixed).addClass(m.bottom),n.onStick.call(T)},unbind:function(){w.is.bound()&&(w.debug("Removing container bound position on element"),w.remove.offset(),g.removeClass(m.bound).removeClass(m.top).removeClass(m.bottom))},unfix:function(){w.is.fixed()&&(w.debug("Removing fixed position on element"),w.remove.offset(),g.removeClass(m.fixed).removeClass(m.top).removeClass(m.bottom),n.onUnstick.call(T))},reset:function(){w.debug("Reseting elements position"),w.unbind(),w.unfix(),w.resetCSS(),w.remove.offset(),w.remove.lastScroll()},resetCSS:function(){g.css({width:"",height:""}),x.css({height:""})},setting:function(e,t){if($.isPlainObject(e))$.extend(!0,n,e);else{if(t===o)return n[e];n[e]=t}},internal:function(e,t){if($.isPlainObject(e))$.extend(!0,w,e);else{if(t===o)return w[e];w[e]=t}},debug:function(){n.debug&&(n.performance?w.performance.log(arguments):(w.debug=Function.prototype.bind.call(console.info,console,n.name+":"),w.debug.apply(console,arguments)))},verbose:function(){n.verbose&&n.debug&&(n.performance?w.performance.log(arguments):(w.verbose=Function.prototype.bind.call(console.info,console,n.name+":"),w.verbose.apply(console,arguments)))},error:function(){w.error=Function.prototype.bind.call(console.error,console,n.name+":"),w.error.apply(console,arguments)},performance:{log:function(e){var t,o,i;n.performance&&(t=(new Date).getTime(),i=s||t,o=t-i,s=t,r.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:T,"Execution Time":o})),clearTimeout(w.performance.timer),w.performance.timer=setTimeout(w.performance.display,0)},display:function(){var e=n.name+":",t=0;s=!1,clearTimeout(w.performance.timer),$.each(r,function(e,o){t+=o["Execution Time"]}),e+=" "+t+"ms",i&&(e+=" '"+i+"'"),(console.group!==o||console.table!==o)&&r.length>0&&(console.groupCollapsed(e),console.table?console.table(r):$.each(r,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),r=[]}},invoke:function(e,t,n){var i=y,s,r,l;return t=t||a,n=T||n,"string"==typeof e&&i!==o&&(e=e.split(/[\. ]/),s=e.length-1,$.each(e,function(t,n){var l=t!=s?n+e[t+1].charAt(0).toUpperCase()+e[t+1].slice(1):e;if($.isPlainObject(i[l])&&t!=s)i=i[l];else{if(i[l]!==o)return r=i[l],!1;if(!$.isPlainObject(i[n])||t==s)return i[n]!==o?(r=i[n],!1):!1;i=i[n]}})),$.isFunction(r)?l=r.apply(n,t):r!==o&&(l=r),$.isArray(f)?f.push(l):f!==o?f=[f,l]:l!==o&&(f=l),r}},c?(y===o&&w.initialize(),w.invoke(l)):(y!==o&&y.invoke("destroy"),w.initialize())}),f!==o?f:this},$.fn.sticky.settings={name:"Sticky",namespace:"sticky",debug:!1,verbose:!0,performance:!0,pushing:!1,context:!1,scrollContext:e,offset:0,bottomOffset:0,jitter:5,observeChanges:!1,onReposition:function(){},onScroll:function(){},onStick:function(){},onUnstick:function(){},onTop:function(){},onBottom:function(){},error:{container:"Sticky element must be inside a relative container",visible:"Element is hidden, you must call refresh after element becomes visible",method:"The method you called is not defined.",invalidContext:"Context specified does not exist",elementSize:"Sticky element is larger than its container, cannot create sticky."},className:{bound:"bound",fixed:"fixed",supported:"native",top:"top",bottom:"bottom"}}}(jQuery,window,document);